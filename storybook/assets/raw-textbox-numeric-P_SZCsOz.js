import{c as createComponent,_,h,T}from"./create-component-a83A1_Pu.js";import{g as getCurrentFromRef}from"./get-current-from-ref-KzY6_NOj.js";import{n as noop}from"./no-op-Uu3q6ZSj.js";import{c as computeNextValue}from"./compute-next-value-v04i_0LO.js";import{i as isKeyCodeCharacterGenerating}from"./is-keycode-character-generating-0Qf6Kf4s.js";import{u}from"./jsxRuntime.module-mP9ZGqev.js";import{M as MIXED_STRING,a as MIXED_NUMBER}from"./mixed-values-kiIAV0Ly.js";const floatOperandRegex=/^-?\d*(?:\.\d*)?$/,integerOperandRegex=/^-?\d*$/,operatorRegex=/[+\-*/]/,operatorSuffixRegex=/[+\-*/]$/,numbersRegex=/\d/,invalidCharactersRegex=/[^\d.+\-*/]/;function evaluateNumericExpression(value){return value===""||numbersRegex.test(value)===!1||invalidCharactersRegex.test(value)===!0?null:operatorRegex.test(value)===!0?operatorSuffixRegex.test(value)===!0?eval(value.substring(0,value.length-1)):eval(value):parseFloat(value)}function isValidNumericInput(t,r={integersOnly:!1}){const l=(t[0]==="-"?t.substring(1):t).split(operatorRegex);let i=-1;for(;++i<l.length;){const c=l[i];if(c===""&&i!==l.length-1||(r.integersOnly===!0?integerOperandRegex:floatOperandRegex).test(c)===!1)return!1}return!0}const EMPTY_STRING$1="",fractionalPartRegex=/\.([^.]+)/,nonDigitRegex=/[^\d.]/;function formatEvaluatedValue(t,r,l){if(t===null)return EMPTY_STRING$1;const i=countSignificantFigures(nonDigitRegex.test(r)===!0?`${t}`:r);return appendSuffix(formatSignificantFigures(t,i),l)}function countSignificantFigures(t){const r=fractionalPartRegex.exec(t);return r===null?0:r[1].length}function formatSignificantFigures(t,r){if(r===0)return`${t}`;const l=fractionalPartRegex.exec(`${t}`);if(l===null)return`${t}.${"0".repeat(r)}`;const i=l[1],c=r-i.length;return`${t}${"0".repeat(c)}`}function appendSuffix(t,r){return typeof r>"u"?t:t===EMPTY_STRING$1?EMPTY_STRING$1:`${t}${r}`}const FRACTION_DIGITS=3,EMPTY_STRING="",RawTextboxNumeric=createComponent(function({disabled:t=!1,incrementBig:r=10,incrementSmall:l=1,integer:i=!1,maximum:c,minimum:s,onBlur:V=noop,onFocus:y=noop,onInput:D=noop,onMouseDown:G=noop,onKeyDown:w=noop,onNumericValueInput:P=noop,onValueInput:b=noop,placeholder:F,propagateEscapeKeyDown:x=!0,revertOnEscapeKeyDown:Y=!1,suffix:f,validateOnBlur:S,value:n,...O},E){if(typeof s<"u"&&typeof c<"u"&&s>=c)throw new Error("`minimum` must be less than `maximum`");const $=_(null),M=_(!1),[I,d]=h(EMPTY_STRING),p=T(function(e){const o=getCurrentFromRef($);o.value=e;const a=new window.Event("input",{bubbles:!0,cancelable:!0});o.dispatchEvent(a)},[]),X=T(function(e){if(V(e),M.current===!0){M.current=!1;return}if(typeof S<"u"){const o=evaluateValue(n,f),a=S(o);if(typeof a=="number"){p(formatEvaluatedValue(a,n,f)),d(EMPTY_STRING);return}if(a===null){p(EMPTY_STRING),d(EMPTY_STRING);return}if(a===!1){n!==I&&p(I),d(EMPTY_STRING);return}}if(typeof f<"u"&&n===f){p(EMPTY_STRING),d(EMPTY_STRING);return}if(n!==EMPTY_STRING&&n!==MIXED_STRING){const o=evaluateValue(n,f),a=formatEvaluatedValue(o,n,f);n!==a&&p(a)}d(EMPTY_STRING)},[V,I,p,f,S,n]),k=T(function(e){y(e),d(n),e.currentTarget.select()},[y,n]),N=T(function(e){D(e);const o=e.currentTarget.value;b(o);const a=evaluateValue(o,f);P(a)},[D,P,b,f]),A=T(function(e){w(e);const o=e.key;if(o==="Escape"){Y===!0&&(M.current=!0,p(I),d(EMPTY_STRING)),x===!1&&e.stopPropagation(),e.currentTarget.blur();return}const a=e.currentTarget;if(o==="ArrowDown"||o==="ArrowUp"){const R=e.shiftKey===!0?r:l;if(e.preventDefault(),n===EMPTY_STRING||n===MIXED_STRING){const z=function(){return typeof s<"u"&&s>0?s:typeof c<"u"&&c<0?c:0}(),B=evaluateValueWithDelta(z,o==="ArrowDown"?-1*R:R),H=restrictValue(B,s,c),J=formatEvaluatedValue(H,n,f);a.value=J,a.select(),N(e);return}const g=evaluateValue(n,f);if(g===null)throw new Error("`number` is `null`");const j=evaluateValueWithDelta(g,o==="ArrowDown"?-1*R:R),q=restrictValue(j,s,c),C=formatEvaluatedValue(q,n,f);if(C===n)return;a.value=C,a.select(),N(e);return}if(!(e.ctrlKey===!0||e.metaKey===!0)&&isKeyCodeCharacterGenerating(e.keyCode)===!0){const R=trimSuffix(n===MIXED_STRING?e.key:computeNextValue(a,e.key),f);if(isValidNumericInput(R,{integersOnly:i})===!1){e.preventDefault();return}if(typeof s>"u"&&typeof c>"u")return;const g=evaluateNumericExpression(R);if(g===null)return;(typeof s<"u"&&g<s||typeof c<"u"&&g>c)&&e.preventDefault()}},[N,r,l,i,c,s,w,I,x,Y,p,f,n]),K=T(function(e){G(e),n===MIXED_STRING&&(e.preventDefault(),e.currentTarget.select())},[G,n]),U=T(function(e){if(e.clipboardData===null)throw new Error("`event.clipboardData` is `null`");const o=trimSuffix(computeNextValue(e.currentTarget,e.clipboardData.getData("Text")),f);isValidNumericInput(o,{integersOnly:i})===!1&&e.preventDefault()},[i,f]),W=T(function(e){if($.current=e,E!==null){if(typeof E=="function"){E(e);return}E.current=e}},[E]);return u("input",{...O,ref:W,disabled:t===!0,onBlur:X,onFocus:k,onInput:N,onKeyDown:A,onMouseDown:K,onPaste:U,placeholder:F,spellcheck:!1,tabIndex:0,type:"text",value:n===MIXED_STRING?"Mixed":n})});function restrictValue(t,r,l){return typeof r<"u"?typeof l<"u"?Math.min(Math.max(t,r),l):Math.max(t,r):typeof l<"u"?Math.min(t,l):t}function evaluateValue(t,r){return t===MIXED_STRING?MIXED_NUMBER:t===EMPTY_STRING?null:evaluateNumericExpression(trimSuffix(t,r))}function evaluateValueWithDelta(t,r){return parseFloat((t+r).toFixed(FRACTION_DIGITS))}function trimSuffix(t,r){return typeof r>"u"?t:t.replace(new RegExp(`${r}$`),EMPTY_STRING)}export{RawTextboxNumeric as R};
